function addEventClick(){$("#events li").on("click",function(e){e.preventDefault();var n=$(this).attr("data-value");meetupService.getEvent($(this).attr("data-value"),function(e){$("#meeting-title")[0].lastChild.data=e.name}),meetupService.getRsvps(n,"yes",function(e){if(e.results.length>0){var n=0,t=new Array;for(n=0;n<e.results.length;n++)t[n]=[e.results[n].member.member_id];localStorage.attendees=JSON.stringify(t),meetupService.getWinnerDetails(chooseWinnerId(),function(e){})}})}),$("#select-winner").on("click",function(e){meetupService.getWinnerDetails(chooseWinnerId(),function(n){return e.preventDefault(),!1})})}function chooseWinnerId(){var e=JSON.parse(localStorage.attendees),n=Math.floor(Math.random()*e.length),t=e[n];return getWinnerDetails(t),e=$.grep(e,function(e){return e!=t}),localStorage.attendees=JSON.stringify(e),t}function getWinnerDetails(e){meetupService.getWinnerDetails(e,function(e){null!=e&&(null!=e.photo?$("#winnerphoto").attr("src",e.photo.photo_link):$("#winnerphoto").attr("src","./images/nophoto.jpg"),$("#winnername").text(e.name),$("#winnerlocation").text(e.city+", "+e.state))})}api=mu.Api({clientId:"jd6cpjbd8v063nkgn52dpst4g1",onMember:function(e,n){localStorage.token=n,meetupService.setToken(n),$(".connect").hide(),$("#disconnect").show(),$("#loggedout").hide(),$("#loggedin").removeClass("hidden"),$.getJSON("https://api.meetup.com/2/events?access_token="+n+"&member_id=self&time=-2d,2w&page=10&callback=?",function(e){var n=$("#events"),t=[];$.map(e.results,function(e){t.push('<li class="eventid" data-value='+e.id+' data-dismiss="modal">'+e.name.link("#")+"</li>")}),n.append(t.join("")),addEventClick()}),$("#member").html("<a href='#' id='disconnect'>Logout "+e.name+"</a>"),$("#choose-meeting").modal("show")}}),function($){$(function(){$(".connect").on("click",function(e){return e.preventDefault(),api.login(),!1}),$("#member").on("click","#disconnect",function(e){return e.preventDefault(),api.logout(function(){$("#disconnect").hide(),$("#connect").show(),$("loggedin").hide(),window.location.reload()}),!1})})}(jQuery);var meetupService=new function(){var e=localStorage.token,n="https://api.meetup.com",t=function(t,i){$.getJSON(n+"/2/event/"+t+"?callback=?",{access_token:e},function(e){i(e)})},i=function(t,i){$.getJSON(n+"/2/member/"+t+"?callback=?",{access_token:e},function(e){i(e)})},o=function(t,i,o){$.getJSON(n+"/2/rsvps?callback=?",{access_token:e,rsvp:"yes",event_id:t},function(e){o(e)})},c=function(n){e=n};return{getEvent:t,getRsvps:o,getWinnerDetails:i,setToken:c}};